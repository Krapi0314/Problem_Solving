/*
baekjoon 7569��: �丶��

�ð� ����: 1��
�޸� ����: 256 MB

����
ö���� �丶�� ���忡���� �丶�並 �����ϴ� ū â�� ������ �ִ�. �丶��� �Ʒ��� �׸��� ���� ���ڸ�� ������ ĭ�� �ϳ��� ���� ����, ���ڵ��� �������� �׾� �÷��� â�� �����Ѵ�.
â�� �����Ǵ� �丶��� �߿��� �� ���� �͵� ������, ���� ���� ���� �丶��鵵 ���� �� �ִ�. ���� �� �Ϸ簡 ������, ���� �丶����� ������ ���� �ִ� ���� ���� �丶����� ���� �丶���� ������ �޾� �Ͱ� �ȴ�. �ϳ��� �丶�信 ������ ���� ��, �Ʒ�, ����, ������, ��, �� ���� ���⿡ �ִ� �丶�並 �ǹ��Ѵ�. �밢�� ���⿡ �ִ� �丶��鿡�Դ� ������ ���� ���ϸ�, �丶�䰡 ȥ�� ������ �ʹ� ���� ���ٰ� �����Ѵ�. ö���� â�� ������ �丶����� ��ĥ�� ������ �� �Ͱ� �Ǵ��� �� �ּ� �ϼ��� �˰� �;� �Ѵ�.
�丶�並 â�� �����ϴ� ���ڸ���� ���ڵ��� ũ��� ���� �丶���� ���� ���� �丶����� ������ �־����� ��, ��ĥ�� ������ �丶����� ��� �ʹ���, �� �ּ� �ϼ��� ���ϴ� ���α׷��� �ۼ��϶�. ��, ������ �Ϻ� ĭ���� �丶�䰡 ������� ���� ���� �ִ�.

�Է�
ù �ٿ��� ������ ũ�⸦ ��Ÿ���� �� ���� M,N�� �׾ƿ÷����� ������ ���� ��Ÿ���� H�� �־�����. M�� ������ ���� ĭ�� ��, N�� ������ ���� ĭ�� ���� ��Ÿ����. ��, 2 �� M �� 100, 2 �� N �� 100, 1 �� H �� 100 �̴�. ��° �ٺ��ʹ� ���� ���� ���ں��� ���� ���� ���ڱ����� ����� �丶����� ������ �־�����. ��, ��° �ٺ��� N���� �ٿ��� �ϳ��� ���ڿ� ��� �丶���� ������ �־�����. �� �ٿ��� ���� �����ٿ� ����ִ� �丶����� ���°� M���� ������ �־�����. ���� 1�� ���� �丶��, ���� 0 �� ���� ���� �丶��, ���� -1�� �丶�䰡 ������� ���� ĭ�� ��Ÿ����. �̷��� N���� ���� H�� �ݺ��Ͽ� �־�����.
�丶�䰡 �ϳ� �̻� �ִ� ��츸 �Է����� �־�����.

���
�������� �丶�䰡 ��� ���� ������ �ּ� ��ĥ�� �ɸ������� ����ؼ� ����ؾ� �Ѵ�. ����, ����� ������ ��� �丶�䰡 �;��ִ� �����̸� 0�� ����ؾ� �ϰ�, �丶�䰡 ��� ������ ���ϴ� ��Ȳ�̸� -1�� ����ؾ� �Ѵ�. 
*/

//#define _CRT_SECURE_NO_WARNINGS

#include <bits/stdc++.h>

using namespace std;

int m, n,h;
int arr[100][100][100];
bool discovered[100][100][100] = { false, };

int traverse_cnt;
int next_cnt;
int cnt;

int ans;
int num;

//6������ �����鿡 ���� offset ����
int dx[6] = { 1, 0, -1, 0, 0, 0 };
int dy[6] = { 0, 1, 0, -1, 0, 0 };
int dz[6] = { 0, 0, 0, 0, 1, -1 };

typedef struct 
{
	int x;
	int y;
	int z;
} coordinate;
coordinate cord;

queue<coordinate> q;

void bfs()
{
	while (!q.empty())
	{
		coordinate here = q.front(); q.pop();

		//������, 6������ �����鿡 ���ؼ��� üũ!!! (���� for������ ��� ���� Ȯ���� �ʿ� ����!)
		for (int k = 0; k < 6; k++)
		{
			//��ǥ��� ������ dfs,bfs �������� ���� ������ Ȯ���Ҷ� ����ϴ� ��ũ��!
			int newy = here.y + dy[k];
			int newx = here.x + dx[k];
			int newz = here.z + dz[k];
			if (newx >= 0 && newx < m && newy >= 0 && newy < n && newz >= 0 && newz < h && !discovered[newz][newy][newx] && arr[newz][newy][newx] != -1)
			{
				discovered[newz][newy][newx] = true;
				arr[newz][newy][newx] = 1;
				cord.x = newx; cord.y = newy; cord.z = newz;
				q.push(cord);
				next_cnt++;
			}
		}

		cnt++;
		if (cnt == traverse_cnt)
		{
			ans++;
			traverse_cnt = next_cnt;
			cnt = 0;
			next_cnt = 0;
		}
	}
}

int main(void)
{
	ios_base::sync_with_stdio(false);
	cin.tie(NULL);
	cout.tie(NULL);

	cin >> m >> n >> h;
	for (int k = 0; k < h; k++)
	{
		for (int i = 0; i < n; i++)
		{
			for (int j = 0; j < m; j++)
			{
				cin >> num;

				if (num == 1)
				{
					traverse_cnt++;
					cord.z = k; cord.y = i; cord.x = j;
					q.push(cord); //ť�� �丶����� ��ġ�� �̸� Ǫ���ؼ� bfs�� ���ÿ� bfs�� �̷�������� �Ѵ�
					discovered[k][i][j] = true;
				}

				arr[k][i][j] = num;
			}
		}
	}

	bfs(); //bfs�� ť�� �̸� �丶��(1)���� ��ġ�� �� �����Ƿ�, �Ѳ����� bfs ������ ����


	//��������� 0�� ���������� -> �� ������ �Ұ�
	int flag = 0;
	for (int k = 0; k < h; k++)
	{
		for (int i = 0; i < n; i++)
		{
			for (int j = 0; j < m; j++)
			{
				if (arr[k][i][j] == 0)
				{
					flag = 1;
				}
			}
		}
	}

	if (flag == 1)
	{
		cout << "-1";
	}
	else
	{
		cout << ans - 1;
	}
}

/*
2���� -> 3���� Ȯ��
	�˻��ؾ� �ϴ� ������ 4���� -> 6�������� ���ϰ�
	arr, discovered 3�������� Ȯ��
	����ü�� x,y,z ���� (pair ��� �Ұ�)

!!! �丶�� (1)�� ���� ���� ���� �� �ְ�, �̵��� �Ѳ����� �ֺ� �丶�並 �Ͱ� ����Ƿ�, bfs ���� �� ť�� �̸� ù ������ �丶��(1)���� ��ġ�� ���� ������ �丶��(1)���� bfs�� �����!!!


bfs, �丶�䰡 ��� ���� ������ �ּ� ��¥ ���ϱ�

���� m, ���� n �Է�
�丶�� ���� �Է� �� �迭�� ����
	if 1 �Է�
		traverse_cnt++ (�� �Ͽ� ť���� ���� �����ϴ� �������� ��)

for �迭 ��ȸ�ϸ鼭
	if �� == 1
		bfs

bfs(��ǥ)
	discovered[��ǥ] true
	ť�� Ǫ��

	while(!ť)
		start = ť pop
		for �迭
			if 6���⿡ �����ϰ�, ���� �߰����� ��������
				ť�� Ǫ��
				travsere_cnt++

	if traverse 0�� �ƴϸ�
		ans++
 */
